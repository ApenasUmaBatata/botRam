const db = require("quick.db"); // Puxando a nossa Database *Instale utilizando: npm i quick.db --save
const {MessageEmbed} = require("discord.js"); // puxando a livraria Discord.js

module.exports = {
  config: {
    name: "apostar",
    aliases: ["aposta", "sorte"]
  },
  run: async (bot, message, args, tools) => {
    //await message.react("âœ…");

    var money = await db.get(`money_${message.author.id}`); // Puxando da Database, a quantia de 'money' do usuÃ¡rio
    const autor = message.author.username;
    var numeroaposta = parseInt(args[0]); // Definindo uma variÃ¡vel para o nÃºmero que o usuÃ¡rio vai apostar
    if (!numeroaposta)
      return message.reply("escreva a quantia que deseja apostar!"); // Caso o usuÃ¡rio nÃ£o escreva nada
    if (isNaN(numeroaposta))
      return message.reply("isso nÃ£o Ã© um nÃºmero :thinking:"); // Caso ele nÃ£o coloque um nÃºmero

    if (numeroaposta > money) {
      // Caso o nÃºmero que o usuÃ¡rio deseja apostar seja maior que o que ele possui na database
      return message.channel.send(
        `${autor} VocÃª nÃ£o possui **ğŸ”† ${numeroaposta}** moedas sagradas!`
      );
    }

    if (message.content.includes("-")) {
      // Caso o usuÃ¡rio tente botar um - (menos) no nÃºmero (isso pode gerar um bug, que mesmo ele perdendo, irÃ¡ ganhar, pois menos + menos Ã© mais (+))
      return message.reply(`hmmmm, quer abusar safadenho?`);
    }
    var random = Math.floor(Math.random() * (3 - 1) + 1); // Um sistema randÃ´mico
    if (random === 2) {
      // caso esse sistema caia em 3, o usuÃ¡rio terÃ¡ ganhado

      message.channel.send(
        `${autor} apostou **ğŸ”† ${numeroaposta}** moedas sagradas e **GANHOU**!`
      ); // fazendo uma conta, puxando o 'money' que o usuÃ¡rio tinha no comeÃ§o mais o que ele ganhou
      db.add(`money_${message.author.id}`, numeroaposta); // adicionando na conta do usuÃ¡rio o que ele apostou
    } else {
      // caso o nÃºmero randÃ´mico nÃ£o caia em trÃªs (3)

      message.channel.send(
        `${autor} apostou **ğŸ”† ${numeroaposta}** moedas sagradas e **PERDEU**!`
      ); // fazendo uma conta, puxando o 'money' que ele comeÃ§ou menos o que ele perdeu na aposta
      db.subtract(`money_${message.author.id}`, numeroaposta); // removendo o que ele apostou
    }
  }
};
